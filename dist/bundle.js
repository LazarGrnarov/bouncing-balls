!function(t){var i={};function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)e.d(n,s,function(i){return t[i]}.bind(null,s));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=1)}([function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.hypot=function(t,i){return Math.sqrt(t*t+i*i)},t.generateSign=function(){return Math.random()>.5?1:-1},t.randomRange=function(t,i,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var s=Math.random()*(i-t)+t;return e&&(s|=0),s*(n?1:this.generateSign())},t.randomChoice=function(t){return t[Math.floor(Math.random()*t.length)]},t}();i.Utils=n},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e(2);console.log("This is a browser feature intended for developers. If someone told you to copy-paste something here to enable a feature or 'hack' someone's account, it is a scam and will give them access to your computer.");new n.Draw(100,2,10)},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e(3),s=e(0),o=function(){function t(t,i,e){var s=this;void 0===t&&(t=100),void 0===i&&(i=1),void 0===e&&(e=10),this.canvas=document.getElementById("canvas"),this.label=document.getElementById("info"),this.start=null,this.BALL_LIMIT=10,this.STEP=t,this.MIN_BALLS_PER_CLICK=i,this.MAX_BALLS_PER_CLICK=e,this.BALL_LIMIT=this.canvas.width*this.canvas.height*.3/(10*Math.PI*2)|0,this.label=document.getElementById("info"),this.toggleButton=document.getElementById("toggle"),this.restartButton=document.getElementById("restart"),this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d");var o=this.canvas.getBoundingClientRect();this.CANVAS_TOP=o.top,this.CANVAS_LEFT=o.left,this.ctx.canvas.width=window.innerWidth,this.ctx.canvas.height=window.innerHeight;var r=new n.Point(this.ctx.canvas.width,this.ctx.canvas.height);window.addEventListener("resize",this.resizeWindow.bind(this)),this.toggleButton.addEventListener("click",this.toggle.bind(this)),this.restartButton.addEventListener("click",this.restart.bind(this)),this.canvas.addEventListener("click",(function(t){s.main(new n.Point(t.clientX-s.CANVAS_LEFT,t.clientY-s.CANVAS_TOP))})),this.service=new n.BouncyService([],r)}return t.prototype.restart=function(){var t=this;this.service.running=!1,this.service.items=[],window.setTimeout((function(){window.cancelAnimationFrame(t.raf)}),16)},t.prototype.main=function(t){var i=this;if(this.service.items.length>this.BALL_LIMIT)return this.label.removeAttribute("hidden"),void window.setTimeout((function(){i.label.setAttribute("hidden","true")}),1500);for(var e=s.Utils.randomRange(this.MIN_BALLS_PER_CLICK,this.MAX_BALLS_PER_CLICK,!0,!0);e>0;){this.service.running&&(window.cancelAnimationFrame(this.raf),this.service.running=!1);new n.Ball(new n.Point(t.X,t.Y),this.service.items.length,this.service);e--}this.service.running||(this.raf=window.requestAnimationFrame((function(t){return i.draw(t)})),this.service.running=!0)},t.prototype.draw=function(t){var i=this;this.start||(this.start=t),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.service.items.forEach((function(t){t.move(t.deltaX,t.deltaY),i.drawBall(t)})),t-this.start>this.STEP&&(this.start=t,this.service.attenuate()),this.raf=window.requestAnimationFrame((function(t){return i.draw(t)}))},t.prototype.drawBall=function(t){var i=this.ctx;i.beginPath(),i.arc(t.coordinates.X,t.coordinates.Y,t.radius,0,2*Math.PI,!0),i.closePath(),i.fillStyle=t.color,i.fill()},t.prototype.toggle=function(){var t=this;this.service.running?(window.cancelAnimationFrame(this.raf),this.service.running=!1,this.toggleButton.textContent="resume"):(this.raf=window.requestAnimationFrame((function(i){return t.draw(i)})),this.service.running=!0,this.toggleButton.textContent="pause")},t.prototype.resizeWindow=function(){var t=this,i=this.canvas.getBoundingClientRect();this.CANVAS_TOP=i.top,this.CANVAS_LEFT=i.left,this.ctx.canvas.width=window.innerWidth,this.ctx.canvas.height=window.innerHeight,this.service.setBoudary(new n.Point(this.ctx.canvas.width,this.ctx.canvas.height)),this.service.items.filter((function(t){return t.noclip})).forEach((function(i){i.coordinates.Y=t.ctx.canvas.height-i.radius})),this.BALL_LIMIT=this.canvas.width*this.canvas.height*.3/(10*Math.PI*2)|0},t}();i.Draw=o},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e(0),s=["blue","green","red","yellow","rgba(231, 84, 128, 1)"],o=function(){function t(t,i){this.X=t,this.Y=i}return t.prototype.distance=function(t){var i=this.X-t.X,e=this.Y-t.Y;return n.Utils.hypot(i,e)},t}();i.Point=o;var r=function(){function t(t,i,e,o,r,a,h,c){this.noclip=!1,this.coordinates=t,this.deltaX=void 0!==o?o:n.Utils.randomRange(5,10),this.deltaY=void 0!==r?r:n.Utils.randomRange(1,3),this.radius=void 0!==a?a:n.Utils.randomRange(5,15,!0,!0),this.color=void 0!==h?h:n.Utils.randomChoice(s),this.handler=e,this.handler.items.push(this),this.id=i,this.immunity=void 0!==c?c:10}return t.prototype.isCollision=function(t){return this.coordinates.distance(t.coordinates)<this.radius+t.radius},t.prototype.move=function(t,i,e){void 0===e&&(e=0);var n=void 0!==t?t:this.deltaX,s=void 0!==i?i:this.deltaY,o=this.handler.boundary;return e>20?this:(0==this.deltaY&&(s=0),void 0!==o?((this.coordinates.Y+this.radius+s>o.Y&&s>0||this.coordinates.Y-this.radius-s<0&&s<0)&&(this.deltaY=-this.deltaY,Math.abs(this.deltaY)<.5&&this.coordinates.Y+this.radius+s>o.Y&&(this.coordinates.Y=o.Y-this.radius,this.deltaY=0)),(this.coordinates.X+this.radius+n>o.X&&n>0||this.coordinates.X-this.radius-Math.abs(n)<0&&n<0)&&(this.deltaX=-this.deltaX),this.coordinates.X+=n,this.coordinates.Y+=s,this.coordinates.X=Math.max(Math.min(this.coordinates.X,o.X-this.radius),this.radius),this.coordinates.Y=Math.max(Math.min(this.coordinates.Y,o.Y-this.radius),this.radius),this.cleanup(),this.handler.handleCollision(this,e+1),this):(this.coordinates.X+=n,void(this.coordinates.Y+=s)))},t.prototype.cleanup=function(){Math.abs(this.deltaX)<.1&&(this.deltaX=0),0==this.deltaX&&0==this.deltaY&&(this.noclip=!0,this.color="rgba(255, 127, 80, 0.3)")},t}();i.Ball=r;var a=function(){function t(t,i){this.items=[],this.running=!1,this.items=t,i&&(this.boundary=i)}return t.prototype.setBoudary=function(t){this.boundary=t},t.prototype.findCollisonPossibleSet=function(){return this.items.filter((function(t){return t.immunity<=0&&!t.noclip}))},t.prototype.findAllCollisionItemsForItem=function(t){return this.findCollisonPossibleSet().filter((function(i){return i.id!=t.id&&t.isCollision(i)}))},t.prototype.handleCollision=function(t,i){var e=!1;this.findAllCollisionItemsForItem(t).forEach((function(n){e=!0,n.move(t.deltaX,t.deltaY,i)})),e&&(t.deltaX=-t.deltaX,t.deltaY=-t.deltaY)},t.prototype.attenuate=function(){this.items.filter((function(t){return 0!=t.deltaY||0!=t.deltaX})).forEach((function(t){t.immunity&&t.immunity>0&&(t.immunity-=1),t.deltaY*=.99,0!=t.deltaY&&(t.deltaY+=.25),t.deltaX*=0!=t.deltaY?.99:.5}))},t}();i.BouncyService=a}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vYXBwLnRzIiwid2VicGFjazovLy8uL2RyYXcudHMiLCJ3ZWJwYWNrOi8vLy4vYmFsbC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImh5cG90IiwiYSIsImIiLCJNYXRoIiwic3FydCIsImdlbmVyYXRlU2lnbiIsInJhbmRvbSIsInJhbmRvbVJhbmdlIiwibWluIiwibWF4IiwiYXNJbnQiLCJvbmx5UG9zaXRpdmUiLCJ0aGlzIiwicmFuZG9tQ2hvaWNlIiwibGlzdCIsImZsb29yIiwibGVuZ3RoIiwiVXRpbHMiLCJjb25zb2xlIiwibG9nIiwiRHJhdyIsInN0ZXAiLCJtaW5CYWxscyIsIm1heEJhbGxzIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImxhYmVsIiwic3RhcnQiLCJCQUxMX0xJTUlUIiwiU1RFUCIsIk1JTl9CQUxMU19QRVJfQ0xJQ0siLCJNQVhfQkFMTFNfUEVSX0NMSUNLIiwid2lkdGgiLCJoZWlnaHQiLCJQSSIsInRvZ2dsZUJ1dHRvbiIsInJlc3RhcnRCdXR0b24iLCJjdHgiLCJnZXRDb250ZXh0IiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIkNBTlZBU19UT1AiLCJ0b3AiLCJDQU5WQVNfTEVGVCIsImxlZnQiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJib3VuZGFyaWVzIiwiUG9pbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVzaXplV2luZG93IiwidG9nZ2xlIiwicmVzdGFydCIsImUiLCJtYWluIiwiY2xpZW50WCIsImNsaWVudFkiLCJzZXJ2aWNlIiwiQm91bmN5U2VydmljZSIsInJ1bm5pbmciLCJpdGVtcyIsInNldFRpbWVvdXQiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsInJhZiIsInBvaW50IiwicmVtb3ZlQXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwibnVtYmVyT2ZCYWxscyIsIkJhbGwiLCJYIiwiWSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInRzIiwiZHJhdyIsInRpbWVzdGFtcCIsImNsZWFyUmVjdCIsImZvckVhY2giLCJiYWxsIiwibW92ZSIsImRlbHRhWCIsImRlbHRhWSIsImRyYXdCYWxsIiwiYXR0ZW51YXRlIiwiYmVnaW5QYXRoIiwiYXJjIiwiY29vcmRpbmF0ZXMiLCJyYWRpdXMiLCJjbG9zZVBhdGgiLCJmaWxsU3R5bGUiLCJjb2xvciIsImZpbGwiLCJ0ZXh0Q29udGVudCIsInNldEJvdWRhcnkiLCJmaWx0ZXIiLCJub2NsaXAiLCJjb2xvcnMiLCJYWCIsIllZIiwiZGlzdGFuY2UiLCJvdGhlciIsImR4IiwiZHkiLCJjb29yZHMiLCJpZCIsImhhbmRsZXIiLCJpbW11bml0eSIsInVuZGVmaW5lZCIsInB1c2giLCJpc0NvbGxpc2lvbiIsIm1vdmVYIiwibW92ZVkiLCJjdXJyZW50Q291bnRlciIsImJvdW5kYXJ5IiwiYWJzIiwiY2xlYW51cCIsImhhbmRsZUNvbGxpc2lvbiIsImZpbmRDb2xsaXNvblBvc3NpYmxlU2V0IiwiZmluZEFsbENvbGxpc2lvbkl0ZW1zRm9ySXRlbSIsIml0ZW0iLCJjb3VudGVyIiwiaGl0IiwibW92ZWFibGUiXSwibWFwcGluZ3MiOiJhQUNFLElB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VixZQUFZVCxPQUl4RCxZQUFBZ0IsZ0JBQUEsU0FBZ0J0QyxFQUEyQjBDLEdBQ3ZDLElBQUlDLEdBQU0sRUFDVjlHLEtBQUsyRyw2QkFBNkJ4QyxHQUFNRCxTQUFRLFNBQUN1QixHQUM3Q3FCLEdBQU0sRUFDTnJCLEVBQU1yQixLQUFLRCxFQUFLRSxPQUFRRixFQUFLRyxPQUFRdUMsTUFFckNDLElBQ0EzQyxFQUFLRSxRQUFVRixFQUFLRSxPQUNwQkYsRUFBS0csUUFBVUgsRUFBS0csU0FJNUIsWUFBQUUsVUFBQSxXQUNJeEUsS0FBS2tELE1BQU1pQyxRQUFPLFNBQUM0QixHQUFtRCxPQUEwQixHQUFuQkEsRUFBU3pDLFFBQWtDLEdBQW5CeUMsRUFBUzFDLFVBQ3pHSCxTQUFRLFNBQUM2QyxHQUNEQSxFQUFpQ2hCLFVBQzdCZ0IsRUFBaUNoQixTQUFXLElBQUlnQixFQUFpQ2hCLFVBQVksR0FFdEdnQixFQUFTekMsUUFBVSxJQUNJLEdBQW5CeUMsRUFBU3pDLFNBQ1R5QyxFQUFTekMsUUFBVSxLQUV2QnlDLEVBQVMxQyxRQUE4QixHQUFuQjBDLEVBQVN6QyxPQUFlLElBQU8sT0FHbkUsRUFsREEsR0FBYSxFQUFBdEIiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiZXhwb3J0IGNsYXNzIFV0aWxzIHtcbiAgICBcbiAgICBzdGF0aWMgaHlwb3QoYTogbnVtYmVyLCBiOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KGEgKiBhICsgYiAqIGIpXG4gICAgfVxuICAgIFxuICAgIHN0YXRpYyBnZW5lcmF0ZVNpZ24oKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgPiAwLjUgPyAxIDogLTE7XG4gICAgfVxuXG4gICAgc3RhdGljIHJhbmRvbVJhbmdlKG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciwgYXNJbnQ6IGJvb2xlYW4gPSBmYWxzZSwgb25seVBvc2l0aXZlOiBib29sZWFuID0gZmFsc2UpOiBudW1iZXIge1xuICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluO1xuICAgICAgICBpZiAoYXNJbnQpIHJhbmRvbSA9IHJhbmRvbSB8IDA7XG4gICAgICAgIHJldHVybiByYW5kb20gKiAob25seVBvc2l0aXZlID8gMSA6IHRoaXMuZ2VuZXJhdGVTaWduKCkpOyAvLyB8IDAgY29udmVydHMgdG8gdG8gaW50LCByYW5kb20gc2lnblxuICAgIH1cblxuICAgIHN0YXRpYyByYW5kb21DaG9pY2UobGlzdCkge1xuICAgICAgICByZXR1cm4gbGlzdFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBsaXN0Lmxlbmd0aCldO1xuICAgIH1cbn0iLCJcbmltcG9ydCB7IERyYXcgfSBmcm9tIFwiLi9kcmF3XCI7XG5jb25zb2xlLmxvZyhcIlRoaXMgaXMgYSBicm93c2VyIGZlYXR1cmUgaW50ZW5kZWQgZm9yIGRldmVsb3BlcnMuIElmIHNvbWVvbmUgdG9sZCB5b3UgdG8gY29weS1wYXN0ZSBzb21ldGhpbmcgaGVyZSB0byBlbmFibGUgYSBmZWF0dXJlIG9yICdoYWNrJyBzb21lb25lJ3MgYWNjb3VudCwgaXQgaXMgYSBzY2FtIGFuZCB3aWxsIGdpdmUgdGhlbSBhY2Nlc3MgdG8geW91ciBjb21wdXRlci5cIilcbmNvbnN0IGQgPSBuZXcgRHJhdygxMDAsIDIsIDEwKTsiLCJcbmltcG9ydCB7IEJhbGwsIEJvdW5jeVNlcnZpY2UsIFBvaW50IH0gZnJvbSAnLi9iYWxsJztcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi91dGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIERyYXcge1xuICAgIHJlYWRvbmx5IFNURVA7IC8vIGluIG1zLCBob3cgb2Z0ZW4gdG8gcmVmcmVzaCBiYWxsIHNwZWVkLCBjaGVjayBpZiBzdG9wcGVkLCBldGMuXG4gICAgcmVhZG9ubHkgTUlOX0JBTExTX1BFUl9DTElDSztcbiAgICByZWFkb25seSBNQVhfQkFMTFNfUEVSX0NMSUNLO1xuICAgIHJlYWRvbmx5IGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJykgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgcmVhZG9ubHkgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XG4gICAgcmVhZG9ubHkgbGFiZWw6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8nKTtcbiAgICByZWFkb25seSB0b2dnbGVCdXR0b246IEhUTUxFbGVtZW50O1xuICAgIHJlYWRvbmx5IHJlc3RhcnRCdXR0b246IEhUTUxFbGVtZW50O1xuICAgIHJhZjogbnVtYmVyO1xuICAgIENBTlZBU19UT1A6IG51bWJlcjtcbiAgICBDQU5WQVNfTEVGVDogbnVtYmVyO1xuICAgIHN0YXJ0OiBudW1iZXIgPSBudWxsO1xuICAgIHNlcnZpY2U6IEJvdW5jeVNlcnZpY2U7XG4gICAgQkFMTF9MSU1JVDogbnVtYmVyID0gMTA7IC8vIHNhZmUgZGVmYXVsdFxuXG4gICAgY29uc3RydWN0b3Ioc3RlcDogbnVtYmVyID0gMTAwLCBtaW5CYWxsczogbnVtYmVyID0gMSwgbWF4QmFsbHMgPSAxMCkge1xuICAgICAgICB0aGlzLlNURVAgPSBzdGVwO1xuICAgICAgICB0aGlzLk1JTl9CQUxMU19QRVJfQ0xJQ0sgPSBtaW5CYWxscztcbiAgICAgICAgdGhpcy5NQVhfQkFMTFNfUEVSX0NMSUNLID0gbWF4QmFsbHM7XG4gICAgICAgIHRoaXMuQkFMTF9MSU1JVCA9ICh0aGlzLmNhbnZhcy53aWR0aCAqIHRoaXMuY2FudmFzLmhlaWdodCAqIDAuMyAvICgxMCAqIE1hdGguUEkgKiAyKSkgfCAwIC8vIGxpbWl0IHRoZSBjYW52YXMgdG8gYWJvdXQgMzAlIG9mIGFyZWEgd2l0aCBiYWxscyAgICAgICAgXG5cbiAgICAgICAgdGhpcy5sYWJlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvJyk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZScpO1xuICAgICAgICB0aGlzLnJlc3RhcnRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGFydCcpO1xuICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcbiAgICAgICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBsZXQgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB0aGlzLkNBTlZBU19UT1AgPSByZWN0LnRvcDtcbiAgICAgICAgdGhpcy5DQU5WQVNfTEVGVCA9IHJlY3QubGVmdDtcbiAgICAgICAgdGhpcy5jdHguY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgIHRoaXMuY3R4LmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICAgIGxldCBib3VuZGFyaWVzID0gbmV3IFBvaW50KHRoaXMuY3R4LmNhbnZhcy53aWR0aCwgdGhpcy5jdHguY2FudmFzLmhlaWdodClcblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNpemVXaW5kb3cuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy50b2dnbGUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVzdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucmVzdGFydC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5tYWluKG5ldyBQb2ludChlLmNsaWVudFggLSB0aGlzLkNBTlZBU19MRUZULCBlLmNsaWVudFkgLSB0aGlzLkNBTlZBU19UT1ApKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gbmV3IEJvdW5jeVNlcnZpY2UoW10sIGJvdW5kYXJpZXMpXG4gICAgfVxuXG4gICAgcmVzdGFydCgpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlLnJ1bm5pbmcgPSBmYWxzZVxuICAgICAgICB0aGlzLnNlcnZpY2UuaXRlbXMgPSBbXVxuICAgICAgICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7IHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnJhZikgfSwgMTYpXG4gICAgfVxuXG4gICAgbWFpbihwb2ludDogUG9pbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VydmljZS5pdGVtcy5sZW5ndGggPiB0aGlzLkJBTExfTElNSVQpIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWwucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHsgdGhpcy5sYWJlbC5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICd0cnVlJykgfSwgMTUwMCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbnVtYmVyT2ZCYWxscyA9IFV0aWxzLnJhbmRvbVJhbmdlKHRoaXMuTUlOX0JBTExTX1BFUl9DTElDSywgdGhpcy5NQVhfQkFMTFNfUEVSX0NMSUNLLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgd2hpbGUgKG51bWJlck9mQmFsbHMgPiAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZXJ2aWNlLnJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5yYWYpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VydmljZS5ydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgbmV3QmFsbCA9IG5ldyBCYWxsKG5ldyBQb2ludChwb2ludC5YLCBwb2ludC5ZKSwgdGhpcy5zZXJ2aWNlLml0ZW1zLmxlbmd0aCwgdGhpcy5zZXJ2aWNlKTsgLy8gcG9pbnQgaXMgcGFzc2VkIGFzIGEgcmVmZXJlbmNlLCBzZW5kIGhlbHAuXG4gICAgICAgICAgICBudW1iZXJPZkJhbGxzLS07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuc2VydmljZS5ydW5uaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnJhZiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKHRzKSA9PiB0aGlzLmRyYXcodHMpKTtcbiAgICAgICAgICAgIHRoaXMuc2VydmljZS5ydW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRyYXcodGltZXN0YW1wOiBudW1iZXIpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0KSB0aGlzLnN0YXJ0ID0gdGltZXN0YW1wO1xuICAgICAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jdHguY2FudmFzLndpZHRoLCB0aGlzLmN0eC5jYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlLml0ZW1zLmZvckVhY2goKGJhbGw6IEJhbGwpID0+IHtcbiAgICAgICAgICAgIGJhbGwubW92ZShiYWxsLmRlbHRhWCwgYmFsbC5kZWx0YVkpO1xuICAgICAgICAgICAgdGhpcy5kcmF3QmFsbChiYWxsKTtcbiAgICAgICAgfSlcbiAgICAgICAgaWYgKHRpbWVzdGFtcCAtIHRoaXMuc3RhcnQgPiB0aGlzLlNURVApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQgPSB0aW1lc3RhbXA7XG4gICAgICAgICAgICB0aGlzLnNlcnZpY2UuYXR0ZW51YXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yYWYgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCh0cykgPT4gdGhpcy5kcmF3KHRzKSk7XG4gICAgfVxuXG4gICAgZHJhd0JhbGwoYmFsbDogQmFsbCkge1xuICAgICAgICBsZXQgY3R4ID0gdGhpcy5jdHg7XG4gICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgY3R4LmFyYyhiYWxsLmNvb3JkaW5hdGVzLlgsIGJhbGwuY29vcmRpbmF0ZXMuWSwgYmFsbC5yYWRpdXMsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcbiAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICBjdHguZmlsbFN0eWxlID0gYmFsbC5jb2xvcjtcbiAgICAgICAgY3R4LmZpbGwoKTtcbiAgICB9XG5cbiAgICB0b2dnbGUoKSB7XG4gICAgICAgIGlmICghdGhpcy5zZXJ2aWNlLnJ1bm5pbmcpIHtcbiAgICAgICAgICAgIHRoaXMucmFmID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgodHMpID0+IHRoaXMuZHJhdyh0cykpO1xuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlLnJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b24udGV4dENvbnRlbnQgPSAncGF1c2UnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMucmFmKTtcbiAgICAgICAgICAgIHRoaXMuc2VydmljZS5ydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdyZXN1bWUnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVzaXplV2luZG93KCkge1xuICAgICAgICBsZXQgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB0aGlzLkNBTlZBU19UT1AgPSByZWN0LnRvcDtcbiAgICAgICAgdGhpcy5DQU5WQVNfTEVGVCA9IHJlY3QubGVmdDtcbiAgICAgICAgdGhpcy5jdHguY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgIHRoaXMuY3R4LmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICAgIHRoaXMuc2VydmljZS5zZXRCb3VkYXJ5KG5ldyBQb2ludCh0aGlzLmN0eC5jYW52YXMud2lkdGgsIHRoaXMuY3R4LmNhbnZhcy5oZWlnaHQpKVxuXG4gICAgICAgIHRoaXMuc2VydmljZS5pdGVtcy5maWx0ZXIoKGJhbGwpID0+IHsgcmV0dXJuIGJhbGwubm9jbGlwIH0pLmZvckVhY2goKGJhbGw6IEJhbGwpID0+IHtcbiAgICAgICAgICAgIGJhbGwuY29vcmRpbmF0ZXMuWSA9IHRoaXMuY3R4LmNhbnZhcy5oZWlnaHQgLSBiYWxsLnJhZGl1c1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLkJBTExfTElNSVQgPSAoKHRoaXMuY2FudmFzLndpZHRoICogdGhpcy5jYW52YXMuaGVpZ2h0ICogMC4zKSAvICgxMCAqIE1hdGguUEkgKiAyKSkgfCAwXG4gICAgfVxufSIsImltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi91dGlscyc7XG5cbmNvbnN0IGNvbG9ycyA9IFsnYmx1ZScsICdncmVlbicsICdyZWQnLCAneWVsbG93JywgJ3JnYmEoMjMxLCA4NCwgMTI4LCAxKSddIC8vICdwaW5rJ1xuXG5cbmV4cG9ydCBjbGFzcyBQb2ludCB7XG4gICAgWDogbnVtYmVyO1xuICAgIFk6IG51bWJlcjtcbiAgICBjb25zdHJ1Y3RvcihYWDogbnVtYmVyLCBZWTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuWCA9IFhYO1xuICAgICAgICB0aGlzLlkgPSBZWTtcbiAgICB9XG5cbiAgICBkaXN0YW5jZShvdGhlcjogUG9pbnQpOiBudW1iZXIge1xuICAgICAgICBsZXQgZHggPSB0aGlzLlggLSBvdGhlci5YO1xuICAgICAgICBsZXQgZHkgPSB0aGlzLlkgLSBvdGhlci5ZO1xuICAgICAgICByZXR1cm4gVXRpbHMuaHlwb3QoZHgsIGR5KTtcbiAgICB9XG59XG5cbmludGVyZmFjZSBNb3ZhYmxlU2hhcGUge1xuICAgIGlkOiBhbnlcbiAgICBjb29yZGluYXRlczogUG9pbnQ7XG4gICAgZGVsdGFYOiBudW1iZXI7XG4gICAgZGVsdGFZOiBudW1iZXI7XG5cbiAgICBtb3ZlKGRlbHRhWDogbnVtYmVyLCBkZWx0YVk6IG51bWJlciwgY291bnRlcj86IG51bWJlcilcbn1cblxuaW50ZXJmYWNlIENvbGxpc2lvbkF3YXJlU2hhcGUgZXh0ZW5kcyBNb3ZhYmxlU2hhcGUge1xuICAgIGltbXVuaXR5OiBudW1iZXI7XG4gICAgbm9jbGlwOiBib29sZWFuO1xuXG4gICAgaXNDb2xsaXNpb24ob3RoZXI6IENvbGxpc2lvbkF3YXJlU2hhcGUpOiBib29sZWFuXG59XG5cbmV4cG9ydCBjbGFzcyBCYWxsIGltcGxlbWVudHMgQ29sbGlzaW9uQXdhcmVTaGFwZSB7XG4gICAgcmVhZG9ubHkgaGFuZGxlcjogTW92ZVNlcnZpY2U8Q29sbGlzaW9uQXdhcmVTaGFwZT47XG4gICAgcmVhZG9ubHkgaWQ6IG51bWJlcjtcbiAgICBjb29yZGluYXRlczogUG9pbnQ7XG4gICAgZGVsdGFYOiBudW1iZXI7XG4gICAgZGVsdGFZOiBudW1iZXI7XG4gICAgcmFkaXVzOiBudW1iZXI7XG4gICAgY29sb3I6IHN0cmluZztcbiAgICBub2NsaXA6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBpbW11bml0eTogbnVtYmVyOyAvLyB0aW1lIGluIG51bWJlciBvZiBzdGVwcy4gVXNlZCB0byBhbGxvdyBjbGlwcGluZyB0byBsZXQgYmFsbHMgc3ByZWFkIG9uIGNyZWF0aW9uXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGNvb3JkczogUG9pbnQsXG4gICAgICAgIGlkOiBudW1iZXIsXG4gICAgICAgIGhhbmRsZXI6IE1vdmVTZXJ2aWNlPENvbGxpc2lvbkF3YXJlU2hhcGU+LFxuICAgICAgICBkZWx0YVg/OiBudW1iZXIsXG4gICAgICAgIGRlbHRhWT86IG51bWJlcixcbiAgICAgICAgcmFkaXVzPzogbnVtYmVyLFxuICAgICAgICBjb2xvcj86IHN0cmluZyxcbiAgICAgICAgaW1tdW5pdHk/OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5jb29yZGluYXRlcyA9IGNvb3JkcztcbiAgICAgICAgdGhpcy5kZWx0YVggPSBkZWx0YVggIT09IHVuZGVmaW5lZCA/IGRlbHRhWCA6IFV0aWxzLnJhbmRvbVJhbmdlKDUsIDEwKVxuICAgICAgICB0aGlzLmRlbHRhWSA9IGRlbHRhWSAhPT0gdW5kZWZpbmVkID8gZGVsdGFZIDogVXRpbHMucmFuZG9tUmFuZ2UoMSwgMyk7XG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzICE9PSB1bmRlZmluZWQgPyByYWRpdXMgOiBVdGlscy5yYW5kb21SYW5nZSg1LCAxNSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvciAhPT0gdW5kZWZpbmVkID8gY29sb3IgOiBVdGlscy5yYW5kb21DaG9pY2UoY29sb3JzKTtcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlcjtcbiAgICAgICAgdGhpcy5oYW5kbGVyLml0ZW1zLnB1c2godGhpcylcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLmltbXVuaXR5ID0gaW1tdW5pdHkgIT09IHVuZGVmaW5lZCA/IGltbXVuaXR5IDogMTA7XG4gICAgfVxuXG4gICAgaXNDb2xsaXNpb24ob3RoZXI6IEJhbGwpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29vcmRpbmF0ZXMuZGlzdGFuY2Uob3RoZXIuY29vcmRpbmF0ZXMpIDwgdGhpcy5yYWRpdXMgKyBvdGhlci5yYWRpdXNcbiAgICB9XG5cbiAgICBtb3ZlKG1vdmVYPzogbnVtYmVyLCBtb3ZlWT86IG51bWJlciwgY3VycmVudENvdW50ZXI6IG51bWJlciA9IDApOiBCYWxsIHtcbiAgICAgICAgbGV0IGRlbHRhWCA9IG1vdmVYICE9PSB1bmRlZmluZWQgPyBtb3ZlWCA6IHRoaXMuZGVsdGFYO1xuICAgICAgICBsZXQgZGVsdGFZID0gbW92ZVkgIT09IHVuZGVmaW5lZCA/IG1vdmVZIDogdGhpcy5kZWx0YVk7XG4gICAgICAgIGxldCBib3VuZGFyeSA9IHRoaXMuaGFuZGxlci5ib3VuZGFyeVxuICAgICAgICBpZiAoY3VycmVudENvdW50ZXIgPiAyMCkgcmV0dXJuIHRoaXM7IC8vIGRvbid0IHRyeSB0byBjYWxjdWxhdGUgbW9yZSBjb2xsaXNpb25zIGZyb20gYSBzaW5nbGUgbW92ZW1lbnRcbiAgICAgICAgaWYgKHRoaXMuZGVsdGFZID09IDApIGRlbHRhWSA9IDA7IC8vIGRvbid0IHVwcm9vdCBzdGlsbCBiYWxsc1xuICAgICAgICBpZiAoYm91bmRhcnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gVmVydGljYWwgbW92ZW1lbnRcbiAgICAgICAgICAgIGlmICgodGhpcy5jb29yZGluYXRlcy5ZICsgdGhpcy5yYWRpdXMgKyBkZWx0YVkgPiBib3VuZGFyeS5ZICYmIGRlbHRhWSA+IDApIHx8ICh0aGlzLmNvb3JkaW5hdGVzLlkgLSB0aGlzLnJhZGl1cyAtIGRlbHRhWSA8IDAgJiYgZGVsdGFZIDwgMCkpIHtcbiAgICAgICAgICAgICAgICAvLyBoaXQgdGhlIGZsb29yLCByZXZlcnNlIGRpcmVjdGlvblxuICAgICAgICAgICAgICAgIHRoaXMuZGVsdGFZID0gLXRoaXMuZGVsdGFZO1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLmRlbHRhWSkgPCAwLjUgJiYgdGhpcy5jb29yZGluYXRlcy5ZICsgdGhpcy5yYWRpdXMgKyBkZWx0YVkgPiBib3VuZGFyeS5ZKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgYmFsbCB0byB0aGUgJ2Zsb29yJyBzaW5jZSBpdCB3b3VsZCBrZWVwIGJvdW5jaW5nIGR1ZSB0byBvdXIgJ2dyYXZpdHknXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29vcmRpbmF0ZXMuWSA9IGJvdW5kYXJ5LlkgLSB0aGlzLnJhZGl1c1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbHRhWSA9IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEhvcml6b250YWwgbW92ZW1lbnRcbiAgICAgICAgICAgIGlmICgodGhpcy5jb29yZGluYXRlcy5YICsgdGhpcy5yYWRpdXMgKyBkZWx0YVggPiBib3VuZGFyeS5YICYmIGRlbHRhWCA+IDApIHx8ICh0aGlzLmNvb3JkaW5hdGVzLlggLSB0aGlzLnJhZGl1cyAtIE1hdGguYWJzKGRlbHRhWCkgPCAwICYmIGRlbHRhWCA8IDApKSB7XG4gICAgICAgICAgICAgICAgLy8gaGl0IHRoZSB3YWxsLCByZXZlcnNlIGRpcmVjdGlvblxuICAgICAgICAgICAgICAgIHRoaXMuZGVsdGFYID0gLXRoaXMuZGVsdGFYO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNvb3JkaW5hdGVzLlggKz0gZGVsdGFYO1xuICAgICAgICAgICAgdGhpcy5jb29yZGluYXRlcy5ZICs9IGRlbHRhWTtcblxuICAgICAgICAgICAgLy8ga2VlcCB0aGUgYmFsbHMgaW5zaWRlXG4gICAgICAgICAgICB0aGlzLmNvb3JkaW5hdGVzLlggPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmNvb3JkaW5hdGVzLlgsIGJvdW5kYXJ5LlggLSB0aGlzLnJhZGl1cyksIHRoaXMucmFkaXVzKVxuICAgICAgICAgICAgdGhpcy5jb29yZGluYXRlcy5ZID0gTWF0aC5tYXgoTWF0aC5taW4odGhpcy5jb29yZGluYXRlcy5ZLCBib3VuZGFyeS5ZIC0gdGhpcy5yYWRpdXMpLCB0aGlzLnJhZGl1cylcblxuICAgICAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG5cbiAgICAgICAgICAgIHRoaXMuaGFuZGxlci5oYW5kbGVDb2xsaXNpb24odGhpcywgY3VycmVudENvdW50ZXIgKyAxKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZG9uJ3QgbmVlZCB0byB3b3J5IGFib3V0IG91dCBvZiBib3VuZHMsIGp1c3QgbW92ZSB0aGUgYmFsbFxuICAgICAgICAgICAgdGhpcy5jb29yZGluYXRlcy5YICs9IGRlbHRhWDtcbiAgICAgICAgICAgIHRoaXMuY29vcmRpbmF0ZXMuWSArPSBkZWx0YVk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjbGVhbnVwKCkge1xuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5kZWx0YVgpIDwgMC4xKSB0aGlzLmRlbHRhWCA9IDA7IC8vIHBhdGllbmNlIGlzIGEgdmlydHVlXG4gICAgICAgIGlmICh0aGlzLmRlbHRhWCA9PSAwICYmIHRoaXMuZGVsdGFZID09IDApIHtcbiAgICAgICAgICAgIHRoaXMubm9jbGlwID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY29sb3IgPSAncmdiYSgyNTUsIDEyNywgODAsIDAuMyknIC8vIGEgc2hhZGUgb2Ygb3JhbmdlIHdpdGggdHJhbnNwYXJlbmN5IHRvIGluZGljYXRlIG5vY2xpcFxuICAgICAgICB9XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgTW92ZVNlcnZpY2U8VCBleHRlbmRzIE1vdmFibGVTaGFwZT4ge1xuICAgIGl0ZW1zOiBUW11cbiAgICBoYW5kbGVDb2xsaXNpb24/OiAoaXRlbTogVCwgY291bnRlcjogbnVtYmVyKSA9PiB2b2lkXG4gICAgcnVubmluZzogYm9vbGVhblxuICAgIGJvdW5kYXJ5PzogUG9pbnRcbn1cblxuZXhwb3J0IGNsYXNzIEJvdW5jeVNlcnZpY2UgaW1wbGVtZW50cyBNb3ZlU2VydmljZTxDb2xsaXNpb25Bd2FyZVNoYXBlPiB7XG4gICAgaXRlbXM6IENvbGxpc2lvbkF3YXJlU2hhcGVbXSA9IFtdO1xuICAgIHJ1bm5pbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBib3VuZGFyeT86IFBvaW50XG4gICAgY29uc3RydWN0b3IoaXRlbXM6IENvbGxpc2lvbkF3YXJlU2hhcGVbXSwgYm91bmRhcnk/OiBQb2ludCkge1xuICAgICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgICAgIGlmIChib3VuZGFyeSkgdGhpcy5ib3VuZGFyeSA9IGJvdW5kYXJ5XG4gICAgfVxuXG4gICAgc2V0Qm91ZGFyeShib3VuZGFyeT86IFBvaW50KSB7XG4gICAgICAgIHRoaXMuYm91bmRhcnkgPSBib3VuZGFyeTtcbiAgICB9XG5cbiAgICBmaW5kQ29sbGlzb25Qb3NzaWJsZVNldCgpOiBDb2xsaXNpb25Bd2FyZVNoYXBlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5maWx0ZXIoKG90aGVyOiBDb2xsaXNpb25Bd2FyZVNoYXBlKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gb3RoZXIuaW1tdW5pdHkgPD0gMCAmJiAhb3RoZXIubm9jbGlwXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZmluZEFsbENvbGxpc2lvbkl0ZW1zRm9ySXRlbShpdGVtOiBDb2xsaXNpb25Bd2FyZVNoYXBlKTogQ29sbGlzaW9uQXdhcmVTaGFwZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZENvbGxpc29uUG9zc2libGVTZXQoKS5maWx0ZXIoKG90aGVyOiBDb2xsaXNpb25Bd2FyZVNoYXBlKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKG90aGVyLmlkICE9IGl0ZW0uaWQpID8gaXRlbS5pc0NvbGxpc2lvbihvdGhlcikgOiBmYWxzZTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBoYW5kbGVDb2xsaXNpb24oYmFsbDogQ29sbGlzaW9uQXdhcmVTaGFwZSwgY291bnRlcjogbnVtYmVyKSB7XG4gICAgICAgIGxldCBoaXQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5maW5kQWxsQ29sbGlzaW9uSXRlbXNGb3JJdGVtKGJhbGwpLmZvckVhY2goKG90aGVyKSA9PiB7XG4gICAgICAgICAgICBoaXQgPSB0cnVlO1xuICAgICAgICAgICAgb3RoZXIubW92ZShiYWxsLmRlbHRhWCwgYmFsbC5kZWx0YVksIGNvdW50ZXIpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaGl0KSB7XG4gICAgICAgICAgICBiYWxsLmRlbHRhWCA9IC1iYWxsLmRlbHRhWDtcbiAgICAgICAgICAgIGJhbGwuZGVsdGFZID0gLWJhbGwuZGVsdGFZO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXR0ZW51YXRlKCkge1xuICAgICAgICB0aGlzLml0ZW1zLmZpbHRlcigobW92ZWFibGU6IE1vdmFibGVTaGFwZSB8IENvbGxpc2lvbkF3YXJlU2hhcGUpID0+IHsgcmV0dXJuIG1vdmVhYmxlLmRlbHRhWSAhPSAwIHx8IG1vdmVhYmxlLmRlbHRhWCAhPSAwIH0pXG4gICAgICAgICAgICAuZm9yRWFjaCgobW92ZWFibGU6IE1vdmFibGVTaGFwZSB8IENvbGxpc2lvbkF3YXJlU2hhcGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoKG1vdmVhYmxlIGFzIENvbGxpc2lvbkF3YXJlU2hhcGUpLmltbXVuaXR5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKCAobW92ZWFibGUgYXMgQ29sbGlzaW9uQXdhcmVTaGFwZSkuaW1tdW5pdHkgPiAwKSAobW92ZWFibGUgYXMgQ29sbGlzaW9uQXdhcmVTaGFwZSkuaW1tdW5pdHkgLT0gMVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtb3ZlYWJsZS5kZWx0YVkgKj0gMC45OTtcbiAgICAgICAgICAgICAgICBpZiAobW92ZWFibGUuZGVsdGFZICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbW92ZWFibGUuZGVsdGFZICs9IDAuMjU7IC8vICdncmF2aXR5J1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtb3ZlYWJsZS5kZWx0YVggKj0gKG1vdmVhYmxlLmRlbHRhWSAhPSAwKSA/IDAuOTkgOiAwLjU7IC8vIHNsb3cgZG93biBob3Jpem9udGFsIG1vdmVtZW50IG1vcmUgaWYgdGhlIGJhbGwgaXNuJ3QgYm91bmNpbmdcbiAgICAgICAgICAgIH0pXG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==